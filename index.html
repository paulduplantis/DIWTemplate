<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIWTemplate</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #333;
            color: #fff;
            padding: 20px 0;
            text-align: center;
        }
        main {
            padding: 20px;
        }
        .carousel-section {
            margin-bottom: 40px;
            text-align: center;
        }
        .carousel-container {
            display: inline-block;
            text-align: left;
            width: 75%; /* Set the container width to 75% */
            overflow: hidden;
            position: relative;
        }
        .carousel-item {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 20px;
            padding: 15px;
            display: flex;
            align-items: center;
            flex-shrink: 0;
            width: 300px;
            height: 250px; /* Set a fixed height */
            box-sizing: border-box;
            overflow: hidden; /* Ensure content doesn't overflow */
        }
        .carousel-item img {
            max-width: 100px;
            max-height: 100px;
            margin-right: 10px;
        }
        .carousel-item h3 {
            margin: 0;
            font-size: 1.1em;
        }
        .carousel-item p {
            flex-grow: 1;
            margin: 10px 0 0;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .carousel {
            width: 100%;
            max-width: 100%;
            overflow-x: scroll; /* Ensure the scrollbar is visible */
            white-space: nowrap;
            display: flex;
            position: relative;
        }
        .carousel-inner {
            display: flex;
            transition: transform 0.5s ease;
        }
        .carousel-item {
            display: inline-block;
            min-width: 300px;
            box-sizing: border-box;
        }
        .carousel-controls {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            transform: translateY(-50%);
            pointer-events: none;
        }
        .carousel-controls button {
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            padding: 10px;
            cursor: pointer;
            pointer-events: all;
            z-index: 1;
        }
        footer {
            background-color: #333;
            color: #fff;
            padding: 20px 0;
            text-align: center;
        }
    </style>
</head>
<body>

<header>
    <h1>Welcome to Ancient Roman History</h1>
    <p>Your ultimate resource for all things Ancient Rome</p>
</header>

<main>
    <section class="carousel-section">
        <div class="carousel-container">
            <h2>Latest from Roman History Podcast</h2>
            <div class="carousel">
                <div class="carousel-inner" id="carousel-inner-podcasts">
                    <!-- Podcast items will be dynamically inserted here -->
                </div>
            </div>
            <div class="carousel-controls">
                <button id="prevBtnPodcasts">&#10094;</button>
                <button id="nextBtnPodcasts">&#10095;</button>
            </div>
        </div>
    </section>

    <section class="carousel-section">
        <div class="carousel-container">
            <h2>Roman History Books</h2>
            <div class="carousel">
                <div class="carousel-inner" id="carousel-inner-books">
                    <!-- Book items will be dynamically inserted here -->
                </div>
            </div>
            <div class="carousel-controls">
                <button id="prevBtnBooks">&#10094;</button>
                <button id="nextBtnBooks">&#10095;</button>
            </div>
        </div>
    </section>
</main>

<footer>
    <p>Contact us at: info@ancientromanhistory.com</p>
    <p>Follow us on:
        <a href="facebook-link">Facebook</a> |
        <a href="twitter-link">Twitter</a> |
        <a href="instagram-link">Instagram</a>
    </p>
</footer>

<script>
    const podcastFeedUrl = 'https://historyofrome.libsyn.com/rss';
    const excludedPodcastTitle = 'The Storm Before The Storm: Chapter 1- The Beasts of Italy';

    async function fetchPodcasts() {
        try {
            const response = await fetch(podcastFeedUrl);
            if (!response.ok) {
                console.error('Failed to fetch the RSS feed:', response.status, response.statusText);
                return;
            }
            const text = await response.text();
            const parser = new DOMParser();
            const xml = parser.parseFromString(text, 'application/xml');
            let items = Array.from(xml.querySelectorAll('item'));
            
            // Reverse the items to show oldest first
            items.reverse();
            
            const carouselInnerPodcasts = document.getElementById('carousel-inner-podcasts');

            if (items.length === 0) {
                console.warn('No RSS feed items found.');
                return;
            }

            items.forEach(item => {
                const title = item.querySelector('title').textContent;
                if (title === excludedPodcastTitle) {
                    return; // Skip this item
                }
                const link = item.querySelector('link').textContent;
                const description = item.querySelector('description').textContent;
                const imageUrl = item.querySelector('itunes\\:image') ? item.querySelector('itunes\\:image').getAttribute('href') : 'link-to-default-image.jpg';

                const carouselItem = document.createElement('div');
                carouselItem.classList.add('carousel-item');
                carouselItem.innerHTML = `
                    <div class="rss-item">
                        <img src="${imageUrl}" alt="${title}">
                        <div>
                            <h3>${title}</h3>
                            <p>${description}</p>
                            <a href="${link}" target="_blank">Listen Now</a>
                        </div>
                    </div>
                `;
                carouselInnerPodcasts.appendChild(carouselItem);
            });
        } catch (error) {
            console.error('Error fetching or parsing RSS feed:', error);
        }
    }

    function setupPodcastCarousel() {
        const carouselInnerPodcasts = document.getElementById('carousel-inner-podcasts');
        const prevBtnPodcasts = document.getElementById('prevBtnPodcasts');
        const nextBtnPodcasts = document.getElementById('nextBtnPodcasts');
        let index = 0;

        function showPodcastSlide(i) {
            const items = document.querySelectorAll('#carousel-inner-podcasts .carousel-item');
            if (i >= items.length) index = 0;
            if (i < 0) index = items.length - 1;
            carouselInnerPodcasts.style.transform = `translateX(${-index * 300}px)`;
        }

        prevBtnPodcasts.addEventListener('click', () => {
            index--;
            showPodcastSlide(index);
        });

        nextBtnPodcasts.addEventListener('click', () => {
            index++;
            showPodcastSlide(index);
        });
    }

    // Example array of book data
    const books = [
        {
            title: 'SPQR: A History of Ancient Rome',
            author: 'Mary Beard',
            imageUrl: 'https://m.media-amazon.com/images/I/51DNaiWfllL.jpg',
            link: 'https://www.amazon.com/dp/0670024870'
        },
        {
            title: 'The History of Rome',
            author: 'Livy',
            imageUrl: 'https://m.media-amazon.com/images/I/41NGZX9G4ZL._SX326_BO1,204,203,200_.jpg',
            link: 'https://www.amazon.com/dp/0140448098'
        },
        // Add more book data as needed
    ];

    function loadBooks() {
        const carouselInnerBooks = document.getElementById('carousel-inner-books');
        books.forEach(book => {
            const carouselItem = document.createElement('div');
            carouselItem.classList.add('carousel-item');
            carouselItem.innerHTML = `
                <img src="${book.imageUrl}" alt="${book.title}">
                <div>
                    <h3>${book.title}</h3>
                    <p>${book.author}</p>
                    <a href="${book.link}" target="_blank">View on Amazon</a>
                </div>
            `;
            carouselInnerBooks.appendChild(carouselItem);
        });
    }

    function setupBookCarousel() {
        const carouselInnerBooks = document.getElementById('carousel-inner-books');
        const prevBtnBooks = document.getElementById('prevBtnBooks');
        const nextBtnBooks = document.getElementById('nextBtnBooks');
        let index = 0;

        function showBookSlide(i) {
            const items = document.querySelectorAll('#carousel-inner-books .carousel-item');
            if (i >= items.length) index = 0;
            if (i < 0) index = items.length - 1;
            carouselInnerBooks.style.transform = `translateX(${-index * 300}px)`;
        }

        prevBtnBooks.addEventListener('click', () => {
            index--;
            showBookSlide(index);
        });

        nextBtnBooks.addEventListener('click', () => {
            index++;
            showBookSlide(index);
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        fetchPodcasts();
        setupPodcastCarousel();
        loadBooks();
        setupBookCarousel();
    });
</script>

</body>
</html>
